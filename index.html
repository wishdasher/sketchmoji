<html>
<head>
  <title>SketchMoji</title>

  <link rel="stylesheet" type="text/css" href="styles.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>

  <script type="text/javascript">

  let mousePressed = false;
  let lastX, lastY;
  let ctx;
  // point data to be sent
  let points = {
    x: [],
    y: [],
    t: []
  };

  function init() {
    ctx = document.getElementById('sketchCanvas').getContext("2d");

    $('#sketchCanvas').mousedown(function (e) {
      mousePressed = true;
      draw(e.pageX - $(this).offset().left, e.pageY - $(this).offset().top, false);
    });

    $('#sketchCanvas').mousemove(function (e) {
      if (mousePressed) {
        draw(e.pageX - $(this).offset().left, e.pageY - $(this).offset().top, true);
      }
    });

    $('#sketchCanvas').mouseup(function (e) {
      mousePressed = false;
    });

    $('#sketchCanvas').mouseleave(function (e) {
      mousePressed = false;
    });
  }

  function draw(x, y, isDown) {
      if (isDown) {
        ctx.beginPath();
        ctx.strokeStyle = $('#selColor').val();
        ctx.lineWidth = $('#selWidth').val();
        ctx.lineJoin = "round";
        ctx.moveTo(lastX, lastY);
        ctx.lineTo(x, y);
        ctx.closePath();
        ctx.stroke();
      }
      const time = Date.now();
      points.x.push(x);
      points.y.push(y);
      points.t.push(time);
      console.log(time + ": " + x + ", " + y);
      lastX = x;
      lastY = y;
  }

  function clear() {
    // Use the identity matrix while clearing the canvas
    ctx.setTransform(1, 0, 0, 1, 0, 0);
    ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
    points.x.length = 0;
    points.y.length = 0;
    points.t.length = 0;
  }


  </script>

</head>


<body onload="init();">
  <h1>SketchMoji</h1>

  <div id="app-area">
    <canvas id="sketchCanvas" width="500" height="498"></canvas>
    <div id="suggestion-area">
      <div class="emoji-suggestion" id="emoji-1"></div>
      <div class="emoji-suggestion" id="emoji-2"></div>
      <div class="emoji-suggestion" id="emoji-3"></div>
      <div class="emoji-suggestion" id="emoji-4"></div>
      <div class="emoji-suggestion" id="emoji-5"></div>
    </div>
  </div>
  <button onclick="javascript:clear(); return false;">Clear Area</button>

</body>

</html>
